"use strict";const btnSearch=document.querySelector(".js-btnSearch"),seriesList=document.querySelector(".js-seriesList"),favoriteList=document.querySelector(".js-favoriteList"),favoritesBtn=document.querySelector(".js-favoritesBtn");let series=[],favorites=[];function getSerie(){const e=document.querySelector(".js-inputSearch").value;fetch("https://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{series=e,paintList(),listenFavList()})}function paintList(){seriesList.innerHTML="";for(let e=0;e<series.length;e++){const t=series[e].show.image,s=document.createElement("li");s.setAttribute("class","js-serie seriesList__item"),s.setAttribute("id",""+series[e].show.id);const i=document.createElement("p");i.setAttribute("class","seriesList__item--titleSerie");const r=document.createTextNode(""+series[e].show.name),a=document.createElement("img");a.setAttribute("class","js-poster seriesList__item--poster");const o=document.createElement("p");o.setAttribute("class","seriesList__item--statusSerie");const n=document.createTextNode(""+series[e].show.status);i.appendChild(r),s.appendChild(i),s.appendChild(a),o.appendChild(n),s.appendChild(o),seriesList.appendChild(s),null!==t?(a.setAttribute("src",""+series[e].show.image.medium),a.setAttribute("alt","Poster ${series[i].show.name}")):null===t&&(a.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=TV"),a.setAttribute("alt","Poster no encontrado"));for(let e=0;e<favorites.length;e++)parseInt(s.id)===favorites[e].id&&s.setAttribute("class","js-serie seriesList__item favoriteSearch")}}const paintFavList=function(e){let t=parseInt(e.currentTarget.id);const s=e.currentTarget;for(let e=0;e<series.length;e++)if(t===series[e].show.id){t=series[e].show;void 0===favorites.find(e=>e.id===t.id)?(s.classList.add("favoriteSearch"),favorites.push(t),rePaintFavList()):(s.classList.remove("favoriteSearch"),favorites.splice(t,1),rePaintFavList())}setLocalStorage()};function setLocalStorage(){localStorage.setItem("favorites",JSON.stringify(favorites)),console.log(favorites)}function getLocalStorage(){const e=JSON.parse(localStorage.getItem("favorites"));null!==e&&(favorites=e,rePaintFavList())}const rePaintFavList=function(){let e="";for(let t=0;t<favorites.length;t++)e+='<li class="favoritesList__item">',e+=favorites[t].name,null!==favorites[t].image?e+=`<img src="${favorites[t].image.medium}" alt="Poster ${favorites[t].name}" class="js-poster favoritesList__item--img">`:null===favorites[t].image&&(e+=`<img src=" https://via.placeholder.com/210x295/ffffff/666666/?\n      text=TV" alt="Poster de ${favorites[t].name}" class="js-poster favoritesList__item--img">`),e+=`<i class="fa fa-times-circle js-fa-times-circle" aria-hidden="true" id="${favorites[t].id}"></i>`,e+="</li>";favoriteList.innerHTML=e,listenRemoveFavList()};function removeFavList(e){const t=parseInt(e.currentTarget.id);console.log(t);for(let e=0;e<favorites.length;e++){if(favorites[e].id===t){const t=favorites.findIndex(t=>t===favorites[e]);console.log(t),favorites.splice(t,1),rePaintFavList(),paintList(),listenFavList()}}setLocalStorage()}function clickButtonReset(){favorites=[],rePaintFavList(),paintList(),setLocalStorage(),listenFavList()}const listenRemoveFavList=function(){const e=document.querySelectorAll(".js-fa-times-circle");for(let t=0;t<e.length;t++)e[t].addEventListener("click",removeFavList)},listenFavList=function(){const e=document.querySelectorAll(".js-serie");for(const t of e)t.addEventListener("click",paintFavList)};favoritesBtn.addEventListener("click",clickButtonReset),btnSearch.addEventListener("click",getSerie),getLocalStorage();